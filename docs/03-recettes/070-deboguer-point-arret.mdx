# 🐞 Déboguer

Déboguer signifie observer l’exécution de notre programme étape par étape pour comprendre son comportement, trouver des erreurs (bugs), ou vérifier l’état des variables.

PyCharm offre un excellent environnement de débogage avec des outils visuels intégrés.

---

## Point d'arrêt

Un **point d’arrêt** (*breakpoint*) permet de dire à PyCharm : "Arrête ici quand tu exécutes le programme."

1. Ouvrir un fichier `.py`.
2. Cliquer dans la marge gauche à côté d’une ligne de code pour y placer un point rouge (le point d’arrêt).
<Row>
<Column>

```python showLineNumbers
i = 0
while i < 5:
    carre = i * i
    print(f"{i}² = {carre}")
    i += 1
```

</Column>

<Column>
    ![point](/img/recettes/point_arret.png)
</Column>
</Row>
3. Cliquer sur le bouton ![point](/img/icons/debug.png) **Debug** (à côté du bouton ▶ Run).
4. Le programme s’arrêtera à cette ligne, et PyCharm affichera la fenêtre de débogage
avec la pile d'appels à gauche et les variables à droite :

![point](/img/recettes/pile_variables.png)



:::note Exécution pas à pas

Lorsqu’un point d’arrêt est atteint, on peut faire :

- <img src={require('/img/icons/stop.png').default} alt="Stop" width="24" style={{ verticalAlign: 'middle' }} /> **Stop** : arrêter l’exécution.
- <img src={require('/img/icons/resume.png').default} alt="Resume" width="24" style={{ verticalAlign: 'middle' }} /> **Resume** : continuer l’exécution jusqu’au prochain point d’arrêt rencontré.
- <img src={require('/img/icons/stepover.png').default} alt="Step Over" width="24" style={{ verticalAlign: 'middle' }} /> **Step Over** : exécuter la ligne actuelle (mais sans entrer dans les fonctions appelées).
- <img src={require('/img/icons/stepinto.png').default} alt="Step Into" width="24" style={{ verticalAlign: 'middle' }} /> **Step Into** : entrer dans la fonction appelée pour voir ce qu’elle fait.

:::

:::tip Supprimer un point d’arrêt

Pour retirer un point d’arrêt, cliquer à nouveau dessus dans la marge gauche.

:::

---

## Évaluer une expression

Quand l'exécution est arrêtée à un point d’arrêt, on peut **évaluer** une expression, c'est-à-dire voir le résultat d’un calcul ou le contenu d’une variable.

1. Cliquer dans l'espace **Evaluate Expression** dans la fenêtre de débogage.
2. Taper ou copier-coller une expression Python (par ex. `i + 1`, `carre`, ou `i * i`).
3. Le résultat s’affiche immédiatement, sans modifier le programme (dans *result*).

![point](/img/recettes/evaluate_expression.png)

---

## Visualiser la pile d'appels

:::tip Visualiser la pile d'appels

Le débogueur permet d'inspecter tous les détails de la pile d'appels.<br />

Copiez le code ci-dessous dans un script, mettez un point d'arrêt sur la ligne 12 (`valeur = ...`) et exécutez le script en mode débogage.

```python showLineNumbers
def ajouter(x, y):
    return x + y

def multiplier(x, y):
    return x * y

def calculer_expression(a, b, c):
    somme = ajouter(a, b)
    resultat = multiplier(somme, c)
    return resultat

valeur = calculer_expression(2, 3, 4)
print(valeur)  # Affiche 20
```

Pour *entrer* dans les fonctions appelées en mode débogage, il faut utiliser le bouton **Step Into** <img src={require('/img/icons/stepinto.png').default} alt="Step Into" width="24" style={{ verticalAlign: 'middle' }} />.<br />
Lorsque vous entrez dans la fonction `calculer_expression`, vous voyez :
- cette fonction s'ajouter au sommet de la pile d'appels (à gauche),
- les paramètres `a`, `b` et `c` apparaître dans la liste des variables (à droite) :

<img src={require('/img/recettes/pile_appels1.png').default} width="100%"/>

Si vous appuyez de nouveau sur <img src={require('/img/icons/stepinto.png').default} alt="Step Into" width="24" style={{ verticalAlign: 'middle' }} />, vous entrez dans la fonction `ajouter`.<br />
Vous pouvez voir que la fonction `ajouter` est maintenant au sommet de la pile d'appels, et les paramètres `x` et `y` sont affichés dans la liste des variables :
<img src={require('/img/recettes/pile_appels2.png').default} width="100%"/>
Remarquez que les paramètres `a`, `b` et `c` de `calculer_expression` ne sont plus visibles, car vous êtes maintenant dans la fonction `ajouter` et `a`, `b` et `c` sont **hors de portée**.

Vous pouvez cliquer sur le nom de la fonction `calculer_expression` dans la pile d'appels pour revenir à cette fonction et voir ses paramètres à nouveau :
<img src={require('/img/recettes/pile_appels3.png').default} width="100%"/>

:::

Lorsque vous faite une trace d'un code avec des appels de fonctions, il est nécessaire de noter la pile d'appels et les variables locales à chaque étape.

Le débogueur est alors le meilleur outil pour valider votre trace... sauf en examen!


